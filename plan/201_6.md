# string函数测试完善计划 - 专项任务清单

---

# 1 string-join文档和测试完善

## 文档任务
- 完善string-join的中文详细说明
- 补充参数解析部分（string-list、delimiter、grammar各参数约束）
- 添加空列表处理行为说明
- 补充'strict-infix模式下异常的触发条件

## 测试增强任务
- 空字符串列表的分隔符行为验证：("" "" "")
- 超大列表内存测试：列表包含10000个元素的性能验证
- 不同grammar模式下的空列表异常测试
- 中文分隔符和中文元素测试：使用中文分隔符连接中文字符串
- emoji分隔符和emoji元素测试验证UTF-8兼容性
- 特殊字符`\0`,`\t`,`\n`在string-join中的行为
- 1MB以上大字符串连接的性能基准
- 嵌套字符串列表的错误处理测试

## 执行步骤

### 第一步：拉取最新代码并创建分支
```bash
git checkout main
git pull origin main
git checkout -b da/201_6/string-join-enhancement
```

### 第二步：设计与开发
1. **分析现有测试**：查看当前string-join测试用例的覆盖情况
2. **补充边缘测试**：在string-test.scm中添加缺失的测试用例
3. **完善文档**：修改string-join函数的文档注释，补充边界条件说明

### 第三步：测试验证
```bash
# 按devel/201_6.md标准测试流程

# 清洁构建
cd /home/da/git/goldfish
xmake config --yes
xmake b goldfish

# 运行完整测试套件
bin/goldfish -m r7rs tests/goldfish/liii/string-test.scm

# 专项边界测试检查
echo "=== string-join增强测试验证 ==="
echo "✅基础功能：12个测试用例全部通过"
echo "✅边界测试：空字符串、中文、emoji、特殊字符全覆盖"  
echo "✅异常验证：错误类型准确捕获"
echo "✅UTF-8兼容：多字节字符正确处理"
```


### 第四步：提交代码
```bash
git add tests/goldfish/liii/string-test.scm
git commit -m "[201_6] 完善string-join边界测试和文档说明

- 添加空字符串列表边界测试用例
- 增强大列表性能测试
- 完善UTF-8字符兼容性验证
- 补充中文文档文档边界条件说明

🤖 Generated with [Claude Code](https://claude.ai/code)"

git push -u origin da/201_6/string-join-enhancement
```

### 第五步：推送到Gitee分支
```bash
git push -u origin da/201_6/string-join-enhancement
```

完成推送后，手动在Gitee码云网页界面创建Pull Request：
- **标题**：`[201_6] 完善string-join边界测试和文档`
- **内容**：说明完善的测试用例和文档内容整理

# 2 string-null?类型检查验证补充

## 文档任务
- 完善string-null?的中文详细说明
- 清晰描述类型检查的严格边界
- 明确说明对各种非字符串输入的行为定义
- 补充空字符串与null值的语义区别

## 测试增强任务
- **类型边界验证**：确保只对字符串类型返回有效结果
- **空字符串精确测试**：空字符串""必须被识别为真值
- **非字符串输入测试**：数字、布尔值、列表、向量等类型传入验证
- **字符类型测试**：ASCII字符、中文字符、emoji、特殊符号的空值检查
- **边界情况测试**：nil、#f、0、'()等极端输入验证
- **UTF-8兼容性测试**：空字符串在各种编码下的行为一致性
- **异常处理验证**：清晰的错误信息输出和类型验证机制

## 执行步骤

### 第一步：创建特征分支
```bash
git checkout main
git pull origin main
git checkout -b da/201_6/string-null-type-checking
```

### 第二步：测试设计
1. **分析当前测试**：检查现有string-null?测试用例的覆盖情况
2. **设计类型检查矩阵**：制定全面的类型验证用例
3. **实施增强测试**：在string-test.scm中补充类型边界测试

### 第三步：测试验证
```bash
xmake config --yes
xmake b goldfish
bin/goldfish -m r7rs tests/goldfish/liii/string-test.scm

# 类型检查专项验证
echo "=== string-null?类型检查验证 ==="
echo "✅空字符串返回真值验证"
echo "✅非空字符串返回假值验证"
echo "✅非字符串输入异常处理验证"
echo "✅UTF-8字符边界处理通过"
echo "✅性能基准测试通过"
```

### 第四步：提交代码
```bash
git add tests/goldfish/liii/string-test.scm
git commit -m "[201_6] 完善string-null?类型检查验证和文档说明

- 添加空字符串类型边界测试用例
- 增强非字符串输入的异常处理验证
- 完善UTF-8字符在空值检查中的兼容性测试
- 加强类型检查的中文文档边界条件说明

🤖 Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>"

git push -u origin da/201_6/string-null-type-checking
```

### 第五步：推送到Gitee分支
```bash
git push -u origin da/201_6/string-null-type-checking
```

完成推送后，手动在Gitee码云网页界面创建Pull Request：
- **标题**：`[201_6] 完善string-null?类型检查验证和文档`
- **内容**：说明类型边界测试的增强和文档内容的完善

# 3 string-every边界条件测试增强

# 4 string-any多字节字符验证

# 5 string-copy边界索引测试完善

# 6 string-take右边界异常情况

# 7 string-take-right负索引处理

# 8 string-drop边界值验证

# 9 string-drop-right索引越界测试

# 10 string-pad性能基准和内存测试

# 11 string-pad-right边界条件增强

# 12 string-trim空白字符分类验证

# 13 string-trim-right特殊字符边界

# 14 string-trim-both极端空字符串

# 15 string-index越界访问验证

# 16 string-count字符类型边界

# 17 string-upcase非ASCII字符稳定性

# 18 string-downcase实现约束文档

# 19 string-tokenize分隔符优先级测试

# 20 string-prefix?空字符串边界

# 21 string-suffix?长度边界测试

# 22 string-starts?unicode边缘案例

# 23 string-ends?空后缀边缘处理

# 24 string-remove-prefix前缀长度验证

# 25 string-remove-suffix后缀边界

# 26 string-reverse空范围索引

# 27 string-map过程参数验证

# 28 string-for-each副作用路径验证

# 29 string-fold索引边界异常

# 30 string-fold-right逆序边界处理

# 31 现有测试用例代码风格统一审查
