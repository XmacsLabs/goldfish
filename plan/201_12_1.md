# carè¾¹ç•Œæ¡ä»¶å’Œå¼‚å¸¸å¤„ç†éªŒè¯ - è¯¦ç»†ä»»åŠ¡è¯´æ˜

## ä»»åŠ¡æ¦‚è¿°
å®Œå–„R7RSæ ‡å‡†ä¸­`car`å‡½æ•°çš„æ–‡æ¡£è¯´æ˜å’Œè¾¹ç•Œæ¡ä»¶æµ‹è¯•ï¼Œé‡ç‚¹å…³æ³¨å¼‚å¸¸å¤„ç†æœºåˆ¶å’Œå„ç§è¾“å…¥æƒ…å†µçš„è¡Œä¸ºéªŒè¯ã€‚

## å‡½æ•°å®šä¹‰
caræ˜¯Schemeå†…ç½®å‡½æ•°ï¼Œç”¨äºè·å–åºå¯¹çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆç¬¬ä¸€ä¸ªåˆ†é‡ï¼‰ã€‚è¯¥å‡½æ•°æ˜¯R7RSæ ‡å‡†çš„åŸºæœ¬åˆ—è¡¨æ“ä½œå‡½æ•°ä¹‹ä¸€ã€‚

## è¯­æ³•
----
(car pair)

## å‚æ•°
----
pair : pair?
å¯ä»¥æ˜¯åºå¯¹ï¼ˆå³éç©ºåˆ—è¡¨æˆ–æ˜¾å¼ç‚¹å¯¹ï¼‰ï¼Œä¸èƒ½æ˜¯ç©ºåˆ—è¡¨æˆ–å…¶ä»–å¯¹è±¡ã€‚

## è¿”å›å€¼
------
ä»»æ„ç±»å‹
è¿”å›åºå¯¹çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼ˆcaréƒ¨åˆ†ï¼‰ã€‚æ ¹æ®ä¸åŒçš„åºå¯¹å†…å®¹ï¼Œè¿”å›ç±»å‹å¯ä»¥æ˜¯ç¬¦å·ã€æ•°å­—ã€åˆ—è¡¨ã€ç‚¹å¯¹ç­‰ä»»ä½•å¯¹è±¡ã€‚

## åŸºç¡€è¡Œä¸º
1. caræ˜¯pair?è°“è¯çš„åŸºæœ¬æ“ä½œä¹‹ä¸€ï¼Œä¸cdré…åˆä½¿ç”¨å¤„ç†åºå¯¹æ•°æ®
2. å½“åº”ç”¨äºåˆ—è¡¨æ—¶ï¼Œè¿”å›åˆ—è¡¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ 
3. é€‚ç”¨äºæ‰€æœ‰åºå¯¹æ•°æ®ï¼šä¸è®ºæ˜¯ç‚¹å¯¹ (a . b) è¿˜æ˜¯éç©ºåˆ—è¡¨ (a b c ...)

## è¾¹ç•Œæ¡ä»¶æµ‹è¯•è¦ç‚¹
### 1. ç©ºåˆ—è¡¨è¾¹ç•Œ
- éªŒè¯ç©ºåˆ—è¡¨ä½œä¸ºå‚æ•°æ—¶çš„å¼‚å¸¸æŠ›å‡ºè¡Œä¸º
- ç¡®è®¤é”™è¯¯ç±»å‹ä¸º'wrong-type-arg

### 2. å•å…ƒç´ åˆ—è¡¨éªŒè¯
- éªŒè¯å•å…ƒç´ åˆ—è¡¨è¡Œä¸ºï¼šcaråº”è¿”å›å”¯ä¸€çš„å…ƒç´ 
- ç¡®è®¤è¿”å›å€¼çš„ç±»å‹å’Œæ•°å€¼å‡†ç¡®æ€§

### 3. åµŒå¥—ç»“æ„æ·±åº¦éªŒè¯
- æµ‹è¯•å¤šå±‚åµŒå¥—åˆ—è¡¨ç»“æ„çš„è¾¹ç•Œå¤„ç†
- éªŒè¯caræ˜¯å¦å§‹ç»ˆè¿”å›æœ€å¤–å±‚çš„ç¬¬ä¸€ä¸ªå…ƒç´ 

### 4. å„ç§æ•°æ®ç±»å‹è¾¹ç•Œ
- æ•°å€¼ç±»å‹ï¼ˆæ•´æ•°ã€æµ®ç‚¹æ•°ã€ç²¾ç¡®æ•°ï¼‰
- å­—ç¬¦ç±»å‹ï¼ˆASCIIã€Unicodeï¼‰
- å¸ƒå°”ç±»å‹ï¼ˆ#tã€#fï¼‰
- å­—ç¬¦ä¸²ç±»å‹
- å‘é‡å’Œå­—èŠ‚å‘é‡
- ç¬¦å·å’Œå…³é”®å­—
- è¿‡ç¨‹å¯¹è±¡
- ç‚¹å¯¹ç»“æ„

### 5. å¼‚å¸¸æœºåˆ¶éªŒè¯
- ç©ºåˆ—è¡¨å¿…é¡»æŠ›å‡º'wrong-type-argå¼‚å¸¸
- éåºå¯¹å¯¹è±¡å¿…é¡»æŠ›å‡º'wrong-type-argå¼‚å¸¸
- å‚æ•°æ•°é‡é”™è¯¯å¿…é¡»æŠ›å‡º'wrong-number-of-argså¼‚å¸¸

### 6. å†…å­˜å’Œæ€§èƒ½è¾¹ç•Œ
- æå¤§åˆ—è¡¨ç»“æ„çš„å¤„ç†æ•ˆç‡
- æ·±åº¦åµŒå¥—ç»“æ„çš„æ ˆä½¿ç”¨æµ‹è¯•
- ç‰¹æ®Šç»“æ„ï¼ˆå¾ªç¯åˆ—è¡¨ï¼‰çš„è¡Œä¸ºéªŒè¯

## é”™è¯¯å¤„ç†åœºæ™¯
---------
### wrong-type-arg
å½“å‚æ•°ä¸æ˜¯åºå¯¹æ—¶æŠ›å‡ºé”™è¯¯ï¼Œå…¸å‹æƒ…å†µåŒ…æ‹¬ï¼š
- ç©ºåˆ—è¡¨ '()
- æ•°å€¼ç±»å‹ 123, 3.14
- å­—ç¬¦ä¸²ç±»å‹ "hello"
- å¸ƒå°”å€¼ #t, #f
- å­—ç¬¦ #\a
- å‘é‡ #(1 2 3)
- å­—èŠ‚å‘é‡ #u8(1 2 3)

### wrong-number-of-args
å½“å‚æ•°æ•°é‡ä¸ä¸º1æ—¶æŠ›å‡ºé”™è¯¯ï¼Œå…¸å‹æƒ…å†µåŒ…æ‹¬ï¼š
- æ— å‚æ•°è°ƒç”¨ (car)
- å¤šå‚æ•°è°ƒç”¨ (car '(1 2) '(3 4))

## æµ‹è¯•ç”¨ä¾‹è®¾è®¡åŸåˆ™
1. æ¯ä¸ªè¾¹ç•Œæ¡ä»¶è‡³å°‘8ä¸ªæµ‹è¯•ç”¨ä¾‹
2. å¼‚å¸¸ç±»å‹ç”¨check-catchç²¾ç¡®éªŒè¯
3. æ­£å¸¸æƒ…å†µåŒ…å«å„ç§æ•°æ®ç±»å‹ç»„åˆ
4. åµŒå¥—ç»“æ„éªŒè¯è¾“å…¥è¾“å‡ºä¸€è‡´æ€§
5. ç‰¹æ®Šè¾¹ç•Œå¦‚æå¤§åˆ—è¡¨å’Œæ·±åº¦åµŒå¥—ç»“æ„æµ‹è¯•

## éªŒè¯æ ‡å‡†
- å¿…é¡»èƒ½å¤Ÿæ­£ç¡®å¤„ç†æ‰€æœ‰åˆæ³•åºå¯¹è¾“å…¥
- å¿…é¡»å¯¹éæ³•è¾“å…¥æŠ›å‡ºæŒ‡å®šç±»å‹çš„å¼‚å¸¸
- è¿”å›å€¼çš„æ•°æ®ç±»å‹å¿…é¡»ä¸¥æ ¼éµå®ˆè§„èŒƒ
- ç©ºåˆ—è¡¨å¿…é¡»æŠ›å‡º'wrong-type-argå¼‚å¸¸
- å‚æ•°æ•°é‡é”™è¯¯å¿…é¡»æŠ›å‡º'wrong-number-of-argså¼‚å¸¸

## ç›¸å…³çº¦æŸ
- ä¸å…è®¸å¤„ç†ç©ºåˆ—è¡¨è¾“å…¥
- åªæ¥å—pair?è°“è¯åˆ¤å®šä¸ºçœŸçš„å¯¹è±¡ä½œä¸ºå‚æ•°
- ä¸æ”¯æŒå¯å˜å‚æ•°æ•°é‡
- ä¸å¤„ç†è·¨ç±»å‹è½¬æ¢

## å®ç°æ£€æŸ¥ç‚¹
1. [ ] åŸºç¡€åŠŸèƒ½éªŒè¯å®Œæˆ
2. [ ] ç©ºåˆ—è¡¨å¼‚å¸¸æµ‹è¯•é€šè¿‡
3. [ ] å•å…ƒç´ åˆ—è¡¨æµ‹è¯•éªŒè¯
4. [ ] åµŒå¥—ç»“æ„æ·±åº¦éªŒè¯
5. [ ] å„ç§æ•°æ®ç±»å‹è¾¹ç•Œè¦†ç›–
6. [ ] å¼‚å¸¸æœºåˆ¶å…¨é¢æµ‹è¯•
7. [ ] æ€§èƒ½è¾¹ç•Œæµ‹è¯•éªŒè¯
8. [ ] ä»£ç è¦†ç›–ç‡è¾¾æ ‡

## åˆ†æ­¥æ‰§è¡Œæ­¥éª¤

### é˜¶æ®µ1ï¼šåˆ›å»ºåˆ†æ”¯
```bash
git checkout main
git pull origin main
git checkout -b "$USER/201_12/car-boundary-tests"
```

### é˜¶æ®µ2ï¼šé˜…è¯»ç°æœ‰å®ç°
```bash
# æ£€æŸ¥carå‡½æ•°çš„å½“å‰å®ç°
grep -n "define.*car" goldfish/scheme/base.scm
grep -n "define.*car" goldfish/liii/base.scm

# æ£€æŸ¥å½“å‰æµ‹è¯•ç”¨ä¾‹
grep -A 5 -B 5 "car.*test\|test.*car" tests/goldfish/scheme/list-test.scm
```

### é˜¶æ®µ3ï¼šåˆ†æç°æœ‰æµ‹è¯•ç¼ºå£
1. è®°å½•ç°æœ‰çš„caræµ‹è¯•ç”¨ä¾‹æ•°é‡å’Œå†…å®¹
2. æ£€æŸ¥æ˜¯å¦è¦†ç›–ä»¥ä¸‹è¾¹ç•Œæ¡ä»¶ï¼š
   - [ ] ç©ºåˆ—è¡¨å¼‚å¸¸
   - [ ] å•å…ƒç´ åˆ—è¡¨
   - [ ] åµŒå¥—ç»“æ„
   - [ ] å„ç§æ•°æ®ç±»å‹
   - [ ] å¼‚å¸¸ç±»å‹éªŒè¯

### é˜¶æ®µ4ï¼šç¼–å†™ç¼ºå¤±æµ‹è¯•ç”¨ä¾‹
```bash
# åœ¨base-test.scmä¸­æ‰¾åˆ°åˆé€‚çš„æµ‹è¯•ä½ç½®
# æ·»åŠ ç©ºåˆ—è¡¨å¼‚å¸¸æµ‹è¯•
(check-catch 'wrong-type-arg (car '()))  

# æ·»åŠ å•å…ƒç´ è¾¹ç•Œæµ‹è¯•
(check (car '(a)) => 'a)
(check (car '(1)) => 1)

# æ·»åŠ åµŒå¥—ç»“æ„æµ‹è¯•  
(check (car '((a b) c d)) => '(a b))
(check (car '((((a)))) => '(((a))))

# æ·»åŠ æ•°æ®ç±»å‹è¾¹ç•Œæµ‹è¯•
(check (car '(42)) => 42)
(check (car '("hello")) => "hello")
(check (car '(#t)) => #t)
```

### é˜¶æ®µ5ï¼šéªŒè¯å¼‚å¸¸æœºåˆ¶
```bash
# æµ‹è¯•æ‰€æœ‰å¼‚å¸¸åœºæ™¯
check-catch 'wrong-type-arg (car 123)
check-catch 'wrong-type-arg (car "string")
check-catch 'wrong-type-arg (car #t)
check-catch 'wrong-number-of-args (car)
check-catch 'wrong-number-of-args (car '(1 2) '(3 4))
```

### é˜¶æ®µ6ï¼šæµ‹è¯•è¿è¡ŒéªŒè¯
```bash
xmake config --yes
xmake b goldfish
bin/goldfish tests/goldfish/liii/base-test.scm
```

### é˜¶æ®µ7ï¼šæ–‡æ¡£æ›´æ–°
```bash
# è¡¥å……è¾¹ç•Œæ¡ä»¶æè¿°å’Œé”™è¯¯å¤„ç†è¯´æ˜
```

### é˜¶æ®µ8ï¼šæäº¤æ›´æ”¹
```bash
git add tests/goldfish/liii/base-test.scm
git commit -m "chore: [201_12] å®Œå–„carè¾¹ç•Œæ¡ä»¶æµ‹è¯•å’Œæ–‡æ¡£è¯´æ˜

- æ·»åŠ ç©ºåˆ—è¡¨è¾¹ç•Œæµ‹è¯•ç”¨ä¾‹
- éªŒè¯å„ç§æ•°æ®ç±»å‹çš„å¤„ç†
- è¡¥å……å¼‚å¸¸å¤„ç†æœºåˆ¶æµ‹è¯•
- æ›´æ–°ä¸­æ–‡è¾¹ç•Œæ¡ä»¶æ–‡æ¡£

ğŸ¤– Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>"

git push origin "$USER/201_12/car-boundary-tests"
```

### é˜¶æ®µ9ï¼šåˆ›å»ºPR
```bash
gh pr create --title "[201_12] å®Œå–„carè¾¹ç•Œæ¡ä»¶æµ‹è¯•å’Œæ–‡æ¡£è¯´æ˜" \
  --body "å®Œå–„R7RSä¸­carå‡½æ•°çš„è¾¹ç•Œæ¡ä»¶æµ‹è¯•å’Œæ–‡æ¡£è¯´æ˜

## å˜æ›´å†…å®¹
- å¢åŠ 8ä¸ªè¾¹ç•Œæµ‹è¯•ç”¨ä¾‹
- éªŒè¯ç©ºåˆ—è¡¨å¼‚å¸¸æŠ›å‡ºæœºåˆ¶
- æµ‹è¯•å•å…ƒç´ åˆ—è¡¨è¾¹ç•Œè¡Œä¸º  
- è¡¥å……å„ç§æ•°æ®ç±»å‹å¤„ç†éªŒè¯

## æµ‹è¯•éªŒè¯
- [x] bin/goldfish tests/goldfish/liii/base-test.scm æ‰§è¡Œé€šè¿‡
- [x] å¼‚å¸¸ç±»å‹éªŒè¯å‡†ç¡®
- [x] è¾¹ç•Œæƒ…å†µè¦†ç›–å®Œæ•´

ğŸ¤– Generated with [Claude Code](https://claude.ai/code)

Co-Authored-By: Claude <noreply@anthropic.com>)"
```