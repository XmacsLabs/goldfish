# [200_21] 从 s7.c 拆分出 s7_r7rs.h 和 s7_r7rs.c

## 任务相关的代码文件
- `src/s7.c`
- `src/s7.h`
- 新文件：`src/s7_r7rs.h`
- 新文件：`src/s7_r7rs.c`

## 如何测试
```
xmake config --yes -vD
xmake build
bin/goldfish tests/test_all.scm
```

## 2026/02/13 移除 file-exists? 在 s7.c 中的相关代码
### Why
- `file-exists?` 已在 `goldfish/scheme/boot.scm` 中使用 `g_access` 重新实现
- 避免 s7.c 和 boot.scm 中的重复实现
- 保持 s7.c 的精简，将 R7RS 相关功能移到 Scheme 层实现

### How
1. 从 s7.c 中删除 `g_file_exists` 和 `file_exists_b_7p` 函数实现
2. 从 s7.c 中删除 `sc->file_exists_symbol` 相关的变量声明、初始化和函数选择器设置
3. `file-exists?` 功能完全由 `goldfish/scheme/boot.scm` 中的 Scheme 实现提供

## 2026/02/13 移除 getenv 在 s7.c 中的相关代码
### Why
- R7RS 标准定义的 `get-environment-variable` 函数与 s7.c 中原生实现的 `getenv` 行为有所不同
- 使用 tbox 的 `tb_environment_*` API 重新实现，可以更好地处理跨平台环境变量获取（包括 Windows 和 Unix-like 系统）
- 将 R7RS 相关功能从 s7.c 核心解释器中分离，保持 s7.c 的精简
- 原生 `getenv` 返回字符串，而 R7RS `get-environment-variable` 在变量不存在时应返回 `#f`，需要重新实现以符合标准

### How
1. 从 s7.c 中删除 `g_getenv` 函数实现（位于 `#if WITH_R7RS || WITH_SYSTEM_EXTRAS` 条件块内）
2. 从 s7.c 中删除 `sc->getenv_symbol` 相关的变量声明和初始化
3. 确保 `WITH_R7RS` 或 `WITH_SYSTEM_EXTRAS` 宏下的 getenv 功能完全由外部（goldfish.hpp）提供

## 2026/02/13 拆分 s7_r7rs.c 并重新实现 get-environment-variables
### What
1. 从 `s7.c` 中提取 getenvs 到新文件 `s7_r7rs.c`
2. 创建 `s7_r7rs.h` 头文件，包含 R7RS 相关的函数声明和定义
3. 更新 `s7.c` 和 `s7.h`，移除 R7RS 相关代码，改为包含 `s7_r7rs.h`
4. 更新 `xmake.lua` 构建配置，将 `s7_r7rs.c` 添加到源文件列表

### Why
- 减少 `s7.c` 的文件大小，提高代码可维护性
- 分离关注点，使 R7RS 相关功能模块化
- 便于后续单独测试和优化 R7RS 功能
- 符合模块化设计原则
- **支持 vibe coding**：拆分后 `s7.c` 文件变小，更适合在编辑器中快速浏览和修改，提升开发体验
